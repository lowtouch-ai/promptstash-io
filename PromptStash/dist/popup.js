(()=>{"use strict";const e=[{name:"Business Analyst Report",tags:"analysis, report, business",type:"pre-built",content:"# Your Role\nBusiness Analyst\n\n# Your Task\nAnalyze the provided data and generate a concise report.\n\n# Relevant Background Information\nUse formal tone, focus on key metrics.\n\n# Output Format\nExecutive summary (200 words), followed by bullet points."},{name:"Code Debugging Assistant",tags:"coding, debug, tech",type:"pre-built",content:"# Your Role\nSenior Developer\n\n# Your Task\nIdentify and fix bugs in the provided code snippet.\n\n# Relevant Background Information\nCode is in Python, prioritize efficiency.\n\n# Output Format\nExplanation of issue, corrected code block."},{name:"Content Generator",tags:"marketing, content, quick",type:"pre-built",content:"# Your Role\nContent Writer\n\n# Your Task\nWrite a 500-word blog post on the given topic.\n\n# Relevant Background Information\nCasual tone, SEO-friendly.\n\n# Output Format\nTitle, intro, 3 sections, conclusion."}];console.log(e[0].name),document.addEventListener("DOMContentLoaded",(()=>{const t=document.getElementById("searchBox"),n=document.getElementById("typeSelect"),a=document.getElementById("dropdownResults"),o=document.getElementById("templateName"),s=document.getElementById("templateTags"),l=document.getElementById("promptArea"),r=document.getElementById("fetchBtn"),c=document.getElementById("saveBtn"),d=document.getElementById("saveAsBtn"),m=document.getElementById("deleteBtn"),i=document.getElementById("clearPrompt"),u=document.getElementById("sendBtn");let p=null;function v(){chrome.storage.local.set({sidebarState:{name:o.value,tags:s.value,content:l.value,selectedName:p}})}function g(n,r=""){chrome.storage.sync.get(["templates"],(c=>{const d=c.templates||e;a.innerHTML="";let m=d.filter((e=>"all"===n||e.type===n));r&&(m=m.filter((e=>e.name.toLowerCase().includes(r)||e.tags.toLowerCase().includes(r))),m.sort(((e,t)=>{const n=e.name.toLowerCase().indexOf(r)+e.tags.toLowerCase().indexOf(r),a=t.name.toLowerCase().indexOf(r)+t.tags.toLowerCase().indexOf(r);return n!==a?n-a:e.name.localeCompare(t.name)}))),m.forEach((e=>{const n=document.createElement("div");n.textContent=`${e.name} (${e.tags})`,n.addEventListener("click",(()=>{p=e.name,o.value=e.name,s.value=e.tags,l.value=e.content,t.value=e.name,a.innerHTML="",v()})),a.appendChild(n)}))}))}chrome.storage.local.get(["sidebarState"],(e=>{const t=e.sidebarState||{};o.value=t.name||"",s.value=t.tags||"",l.value=t.content||"",p=t.selectedName||null})),[o,s,l].forEach((e=>{e.addEventListener("input",v)})),t.addEventListener("click",(e=>{e.stopPropagation();const a=t.value.toLowerCase();g(n.value,a)})),t.addEventListener("input",(()=>{const e=t.value.toLowerCase();g(n.value,e)})),n.addEventListener("change",(()=>{g(n.value,t.value.toLowerCase())})),document.addEventListener("click",(e=>{t.contains(e.target)||a.contains(e.target)||(a.innerHTML="")})),c.addEventListener("click",(()=>{p?confirm("Are you sure you want to overwrite the existing template?")&&chrome.storage.sync.get(["templates"],(t=>{const a=t.templates||e,r=a.findIndex((e=>e.name===p));-1!==r?(a[r]={name:o.value,tags:s.value,content:l.value,type:a[r].type||"custom"},chrome.storage.sync.set({templates:a},(()=>{alert("Template saved successfully."),g(n.value),v()}))):alert("Selected template not found.")})):alert("Please select a template to save changes.")})),d.addEventListener("click",(()=>{let t=o.value.trim(),a=s.value.trim();if(!t||!a){if(t||(t=prompt("Please provide a template name:")),a||(a=prompt("Please provide tags (comma-separated):")||""),!t)return;o.value=t,s.value=a}chrome.storage.sync.get(["templates"],(s=>{const r=s.templates||e;if(r.some((e=>e.name===t))){if(t=prompt("Template name already exists. Please provide a new name:"),!t)return;o.value=t}confirm(`Save as new template "${t}"?`)&&(r.push({name:t,tags:a,content:l.value,type:"custom"}),chrome.storage.sync.set({templates:r},(()=>{alert("Template saved successfully."),g(n.value),v()})))}))})),r.addEventListener("click",(()=>{chrome.tabs.query({active:!0,currentWindow:!0},(e=>{chrome.tabs.sendMessage(e[0].id,{action:"getPrompt"},(e=>{e&&e.prompt&&(l.value=e.prompt,v())}))}))})),u.addEventListener("click",(()=>{chrome.tabs.query({active:!0,currentWindow:!0},(e=>{chrome.tabs.sendMessage(e[0].id,{action:"sendPrompt",prompt:l.value},(()=>{window.parent.postMessage({action:"closeSidebar"},"*")}))}))})),m.addEventListener("click",(()=>{p?confirm("Are you sure you want to delete this template?")&&chrome.storage.sync.get(["templates"],(a=>{const r=a.templates||e,c=r.findIndex((e=>e.name===p));-1!==c?(r.splice(c,1),chrome.storage.sync.set({templates:r},(()=>{alert("Template deleted successfully."),p=null,o.value="",s.value="",l.value="",t.value="",g(n.value),v()}))):alert("Selected template not found.")})):alert("Please select a template to delete.")})),i.addEventListener("click",(()=>{l.value="",v()})),[...document.querySelectorAll('[data-bs-toggle="tooltip"]')].map((e=>new bootstrap.Tooltip(e,{delay:{show:500,hide:100}})))}))})();