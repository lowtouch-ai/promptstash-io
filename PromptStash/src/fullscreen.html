<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PromptStash Fullscreen</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body class="light fullscreen">
  <header class="d-flex justify-content-between align-items-center mb-4 position-relative fixed-top p-3">
    <div class="h2 mt-3 mx-2">
      <span id="templateHeader" class="title"></span>
    </div>
    <button id="compressBtn" class="btn position-absolute top-0 end-0 m-2" aria-label="Exit fullscreen" data-bs-toggle="tooltip" data-bs-placement="top" title="Exit fullscreen">
      <svg width="20" height="20"><use href="sprite.svg#compress"></use></svg>
    </button>
  </header>

  <div class="content-area">
    <div class="position-relative mt-2">
      <textarea id="promptArea" class="form-control shadow rounded-1 px-3" style="resize: none; height: calc(100vh - 100px);" aria-label="Prompt text" data-bs-toggle="tooltip" data-bs-placement="top" title="Prompt text"></textarea>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Initialize fullscreen mode
    document.addEventListener("DOMContentLoaded", () => {
      const promptArea = document.getElementById("promptArea");
      const templateHeader = document.getElementById("templateHeader");
      const compressBtn = document.getElementById("compressBtn");

      // Load data from message
      chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {
        if (message.action === "openFullscreen") {
          promptArea.value = message.content;
          templateHeader.textContent = `${message.name} (${message.tags})`;
          document.body.className = message.theme || "light";
        }
      });

      // Save changes on input
      promptArea.addEventListener("input", () => {
        chrome.runtime.sendMessage({
          action: "updateFromFullscreen",
          content: promptArea.value
        });
      });

      // Exit fullscreen
      compressBtn.addEventListener("click", () => {
        window.parent.postMessage({ action: "closeSidebar" }, "*");
      });

      // Initialize tooltips
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]');
      tooltipTriggerList.forEach(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl, {
        delay: { show: 100, hide: 100 }
      }));
    });
  </script>
</body>
</html>